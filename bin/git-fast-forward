#!/usr/bin/env ruby

destination = ARGV[0]

destination_is_a_descendent_of_head = (`git merge-base HEAD #{destination}` == `git rev-parse HEAD`)

if destination_is_a_descendent_of_head
  system("git merge #{destination}")
else
  $stderr.puts("#{destination} is not a descendent of the current branch.  Refusing to fast-forward.")
  exit 1
end
